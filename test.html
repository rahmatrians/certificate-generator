<canvas style="margin-left: 10px;" id="canvas"></canvas>
<label for="uploader">Select file:</label>
<input type="file" id="uploader" />
<label>
    Name:
    <input id="name" type='text'>
</label>
<button>Download</button>
<script>


  // 1.
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  const nameInput = document.getElementById('name');
  
  // 2.
  const reader = new FileReader();
  const img = new Image();
  
  // 3.
  const uploadImage = (e) => {
    reader.onload = () => {
      img.onload = () => {
        drawImage();
      };
      img.src = reader.result;
    };
    reader.readAsDataURL(e.target.files[0]);
  };

  
function drawImage() {
	// ctx.clearRect(0, 0, canvas.width, canvas.height)
    canvas.width = img.width;
    canvas.height = img.height;
    imgWidth = canvas.width * 0.5;
    imgHeight = canvas.height * 0.5;
	ctx.drawImage(img, 0, 0, imgWidth, imgHeight);
	ctx.font = '40px monotype corsiva';
	ctx.fillStyle = '#29e';
    ctx.textAlign = "center";
	ctx.fillText(nameInput.value, imgWidth / 2, imgHeight / 2);
}

nameInput.addEventListener('input', function () {
	drawImage();
})

  // 4.
  const imageLoader = document.getElementById("uploader");
  imageLoader.addEventListener("change", uploadImage);

  // 5.
  function download() {
    const image = canvas.toDataURL();
    const link = document.createElement("a");
    link.href = image;
    link.download = "image.png";
    link.click();
  }
  
  //6.
  document.querySelector("button").addEventListener("click", download);
</script>